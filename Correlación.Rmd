---
title: 'Correlación Y Regresion Lineal Simple'
subtitle: "Bases de datos del Banco Mundial"
author:
  - "Semillero R - FacCA"
  - "Duvan Nieves"
date: "`r Sys.Date()`"
output:
  html_document:
    css: estilo.css
    df_print: paged
    code_folding: hide
    theme: flatly
    highlight: kate
    toc: true
    toc_float:
      smooth_scroll: false
      collapsed: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = F,
                      warning = F,
                      fig.align = "center")
library(tidyr)
library(dplyr)
library(DT)
library(knitr)
library(ggplot2)
library(plotly)
library(psych)
library(GGally)
library(corrplot)
```

# Base de datos

```{r}
Datos <- read.csv("DatosCompletosContinentesAct1.csv",encoding = "UTF-8")
```

# Resumen numérico {.tabset .tabset-pills }

- Media
- Mediana
- Desviación estándar
- Mínimo
- Máximo

## Tabla por defecto

```{r}
Datos %>% 
  select(-c(pais,continente,continente2)) %>% 
  gather(key = "variable",value ="valor") %>% 
  group_by(variable) %>% 
  summarise(media=mean(valor,na.rm = T),
            max=max(valor,na.rm=T),
            min=min(valor,na.rm = T),
            sd=sd(valor,na.rm = T),
            mediana=median(valor,na.rm = T)) 
```

## Tabla con `DT`

```{r}
Datos %>% 
  select(-c(pais,continente,continente2)) %>% 
  gather(key = "variable",value ="valor") %>% 
  group_by(variable) %>% 
  summarise(media=mean(valor,na.rm = T),
            max=max(valor,na.rm=T),
            min=min(valor,na.rm = T),
            sd=sd(valor,na.rm = T),
            mediana=median(valor,na.rm = T)) %>% 
  datatable(data = .,extensions = 'Buttons', 
          options = list( scrollX = TRUE, 
                          fixedColumns = TRUE, 
                          dom = 'Bfrtip',buttons = 
                            list('copy', 
                                 'print', 
                                 list( extend = 'collection', 
                                                        buttons = c('csv', 
                                                                    'excel', 
                                                                    'pdf'), 
                                       text = 'Download'))))
```

## Tabla con `knitr`
```{r}
Datos %>% 
  select(-c(pais,continente,continente2)) %>% 
  gather(key = "variable",value ="valor") %>% 
  group_by(variable) %>% 
  summarise(media=mean(valor,na.rm = T),
            max=max(valor,na.rm=T),
            min=min(valor,na.rm = T),
            sd=sd(valor,na.rm = T),
            mediana=median(valor,na.rm = T)) %>% 
  kable(format ="markdown" )

```


# Gráficos de dispersión {.tabset .tabset-pills }

## Gráfico simple 

- **Gráfico con todos los datos:**

```{r}
ggplotly(
  Datos %>% 
    ggplot(.,aes(x=gasto_militar17,y=gasto_edu16, label=pais))+
    theme_bw()+
    geom_point()+
    geom_smooth(method = "lm", 
                se = F)
)

```

- **Gráfico con filtro sobre dato "atípico" en gasto militar:**

```{r}
ggplotly(
  Datos %>% 
    filter(gasto_militar17 <= 10) %>% 
    ggplot(.,aes(x=gasto_militar17,y=gasto_edu16, label=pais))+
    theme_bw()+
    geom_point()+
    geom_smooth(method = "lm", 
                se = F)
)
```

## Matriz Dispersión 1



```{r,fig.width=9,fig.height=12,dpi= 300}
pairs.panels(
  Datos %>% select_if(is.numeric))

```

- **Matríz de dispersión reducida (Ejemplo)**

```{r,fig.width=9,fig.height=6.5,dpi= 300}
pairs.panels(
  Datos %>% 
    select(gasto_militar17,
           gasto_edu16,
           desempleo17,
           camas14,pib16,
           gasto_id16) %>% 
    select_if(is.numeric))

```

## Matriz Dispersión 2

```{r,fig.width=9,fig.height=6.5,dpi= 300}

ggpairs(
  Datos %>% 
    select(gasto_militar17,
           gasto_edu16,
           desempleo17,
           camas14,pib16,
           gasto_id16)
  
)


```

## Matriz de correlaciones numéricaS

```{r}
#Obtener correlaciones
matriz_cor <- cor(Datos %>% 
                    select(gasto_militar17,
                           gasto_edu16,
                           desempleo17,
                           camas14,pib16,
                           gasto_id16), 
                  use = "pairwise.complete.obs")
matriz_cor
```

## Matriz de correlaciones gráfica

- **Método por defecto:**

```{r,dpi=300}
corrplot(matriz_cor)
```

- **Otro Método gráfico:**

```{r,dpi=300}
corrplot(matriz_cor,method = "pie",type = "upper")
```

